var pokemonRepository = (function() {
  var e = [],
    t = 'https://pokeapi.co/api/v2/pokemon/?limit=150';
  function n(t) {
    e.push(t);
  }
  function i(e) {
    var t = document.querySelector('#modal-container');
    t.innerHTML = '';
    var n = document.createElement('div');
    n.classList.add('modal');
    var i = document.createElement('button');
    i.classList.add('modal-close'),
      (i.innerText = 'Close'),
      i.addEventListener('click', o);
    var a = document.createElement('h1');
    a.innerText = e.name;
    var r = document.createElement('img');
    r.classList.add('modal-img'), r.setAttribute('src', e.imageUrl);
    var l = document.createElement('p');
    l.innerText = 'height : ' + e.height + 'm';
    var c = document.createElement('p');
    c.innerText = 'weight : ' + e.weight + 'kg';
    var s = document.createElement('p');
    s.innerText = 'types : ' + e.types;
    var d = document.createElement('p');
    (d.innerText = 'abilities : ' + e.abilities),
      n.appendChild(i),
      n.appendChild(a),
      n.appendChild(r),
      n.appendChild(l),
      n.appendChild(c),
      n.appendChild(s),
      n.appendChild(d),
      t.appendChild(n),
      t.classList.add('is-visible');
  }
  function o() {
    document.querySelector('#modal-container').classList.remove('is-visible');
  }
  window.addEventListener('keydown', e => {
    var t = document.querySelector('#modal-container');
    'Escape' === e.key && t.classList.contains('is-visible') && o();
  });
  var a = document.querySelector('#modal-container');
  return (
    a.addEventListener('click', e => {
      e.target === a && o();
    }),
    {
      add: n,
      getAll: function() {
        return e;
      },
      addListItem: function(e) {
        var t = document.querySelector('.pokemon-list'),
          n = document.createElement('li'),
          o = document.createElement('button');
        (o.innerText = e.name),
          o.classList.add('my-class'),
          n.appendChild(o),
          t.appendChild(n),
          o.addEventListener('click', function(t) {
            var n;
            (n = e),
              pokemonRepository.loadDetails(n).then(function() {
                console.log(n), i(n);
              });
          });
      },
      loadList: function() {
        return fetch(t)
          .then(function(e) {
            return e.json();
          })
          .then(function(e) {
            e.results.forEach(function(e) {
              var t = { name: e.name, detailsUrl: e.url };
              n(t), console.log(t);
            });
          })
          .catch(function(e) {
            console.error(e);
          });
      },
      loadDetails: function(e) {
        var t = e.detailsUrl;
        return fetch(t)
          .then(function(e) {
            return e.json();
          })
          .then(function(t) {
            (e.imageUrl = t.sprites.front_default),
              (e.height = t.height),
              (e.types = []);
            for (var n = 0; n < t.types.length; n++)
              e.types.push(t.types[n].type.name);
            for (e.abilities = [], n = 0; n < t.abilities.length; n++)
              e.abilities.push(t.abilities[n].ability.name);
            return (e.weight = t.weight), e;
          })
          .catch(function(e) {
            console.error(e);
          });
      },
      showModal: i,
      hideModal: o
    }
  );
})();
pokemonRepository.loadList().then(function() {
  pokemonRepository.getAll().forEach(function(e) {
    pokemonRepository.addListItem(e);
  });
});
